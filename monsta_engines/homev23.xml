<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html b:css='false' b:defaultmessages='false' b:layoutsVersion='3' b:responsive='true' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
    <title>MonstaComics V5.0 - Professional</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'/>
    
    <link href='https://fonts.googleapis.com/css2?family=Bebas+Neue&amp;family=Oswald:wght@500;700&amp;family=Roboto+Condensed:wght@400;700&amp;family=Inter:wght@400;700&amp;display=swap' rel='stylesheet'/>
    
    <b:skin><![CDATA[
        :root {
            --bg: #0b0b0b; --card: #121212;
            --m-green: #00ff88; --m-purple: #a349f5;
            --text: #ffffff; --text-dim: #999;
            --header-h: 65px;
        }

        body { background-color: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; margin: 0; padding: 0; overflow-x: hidden; }

        /* --- MONSTER SPLASH LOADER --- */
        #monster-loader {
            position: fixed; top:0; left:0; width:100%; height:100%; background: var(--bg);
            z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.5s ease, visibility 0.5s;
        }
        .loader-logo { font-family: 'Bebas Neue'; font-size: 50px; color: #fff; letter-spacing: 4px; margin-bottom: 20px; }
        .loader-logo span { color: var(--m-green); text-shadow: 0 0 20px var(--m-green); }
        .loader-bar { width: 200px; height: 3px; background: #222; position: relative; overflow: hidden; border-radius: 5px; }
        .loader-progress { position: absolute; width: 50%; height: 100%; background: linear-gradient(90deg, var(--m-purple), var(--m-green)); animation: loadingMove 1.5s infinite ease-in-out; }
        @keyframes loadingMove { 0% { left: -50%; } 100% { left: 100%; } }

        /* --- HEADER --- */
        header { 
            background: #111; height: var(--header-h); padding: 0 5%; display: flex; align-items: center; justify-content: space-between;
            border-bottom: 2px solid var(--m-purple); position: sticky; top: 0; z-index: 1000;
        }
        .nav-left { display: flex; align-items: center; gap: 15px; }
        .logo { font-family: 'Bebas Neue', cursive; font-size: 30px; cursor: pointer; color: #fff; letter-spacing: 2px; }
        .logo span { color: var(--m-green); }
        .hamburger { font-size: 26px; color: var(--m-green); cursor: pointer; }

        .search-box { background: #1a1a1a; border: 1px solid #333; padding: 8px 15px; border-radius: 4px; display: flex; align-items: center; width: 30%; transition: 0.3s; }
        .search-box:focus-within { border-color: var(--m-green); box-shadow: 0 0 10px rgba(0,255,136,0.2); }
        .search-box input { background: transparent; border: none; color: #fff; width: 100%; outline: none; font-size: 13px; }

        /* --- SIDEBAR (SANKAKU STYLE) --- */
        #sidebar { 
            position: fixed; left: -280px; top: 0; width: 270px; height: 100%; 
            background: #0f0f0f; z-index: 2000; transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border-right: 2px solid var(--m-green); padding: 25px; box-sizing: border-box;
            font-family: 'Roboto Condensed', sans-serif;
        }
        #sidebar.active { left: 0; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1999; display: none; }
        .overlay.active { display: block; }
        
        .side-branding { font-family: 'Bebas Neue'; font-size: 35px; color: #fff; margin-bottom: 30px; border-bottom: 2px solid var(--m-purple); padding-bottom: 10px; }
        .side-branding span { color: var(--m-green); }
        .menu-item { padding: 12px 0; color: #ccc; font-size: 18px; font-weight: 700; text-transform: uppercase; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; }
        .menu-item:hover { color: var(--m-green); }

        /* --- SORT BAR --- */
        .sort-bar { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .sort-btn { background: #1a1a1a; border: 1px solid #333; color: var(--text-dim); padding: 5px 12px; font-size: 11px; font-weight: bold; cursor: pointer; border-radius: 3px; white-space: nowrap; }
        .sort-btn.active { background: var(--m-purple); color: #fff; border-color: var(--m-purple); }

        /* --- HOME GRID (3 COLUMNS MOBILE) --- */
        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
        .manga-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        @media (min-width: 768px) { .manga-grid { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; } }
        
        .manga-card { background: var(--card); border: 1.5px solid #222; position: relative; transition: 0.3s; cursor: pointer; overflow: hidden; }
        .manga-card:hover { border-color: var(--m-green); transform: translateY(-5px); box-shadow: 0 10px 20px rgba(163, 73, 245, 0.3); }
        .manga-card img { width: 100%; aspect-ratio: 3/4; object-fit: cover; display: block; }
        
        .type-tag { position: absolute; top: 0; right: 0; background: var(--m-purple); color: #fff; font-size: 9px; padding: 2px 6px; font-weight: bold; border-bottom-left-radius: 4px; z-index: 10; }
        .card-info { padding: 8px; background: #111; }
        .card-title { font-weight: 700; font-size: 11px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 5px; color: #fff; font-family: 'Oswald'; }
        @media (min-width: 768px) { .card-title { font-size: 13px; } }
        .card-meta { display: flex; justify-content: space-between; align-items: center; font-size: 9px; }
        .rating-star { color: #ffd700; font-weight: bold; }
        .chap-pill { border: 1px solid var(--m-green); color: var(--m-green); padding: 1px 4px; border-radius: 2px; font-weight: bold; }

        /* --- DETAIL VIEW --- */
        #detail-view { display: none; animation: slideUp 0.4s ease; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .detail-header { display: flex; gap: 20px; margin-bottom: 25px; flex-wrap: wrap; }
        .detail-cover { width: 100%; max-width: 220px; border: 3px solid var(--m-green); box-shadow: 0 0 30px rgba(0,0,0,0.8); }
        .detail-info { flex: 1; min-width: 280px; }
        .detail-title { font-family: 'Oswald'; font-size: 35px; color: var(--m-green); margin: 0 0 10px 0; line-height: 1.1; text-transform: uppercase; }
        
        .chapter-list { margin-top: 25px; background: #111; border: 1px solid #222; border-radius: 4px; }
        .chap-item { padding: 15px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; cursor: pointer; transition: 0.2s; }
        .chap-item:hover { background: #1a1a1a; color: var(--m-green); padding-left: 20px; }

        /* --- READER --- */
        #reader-view { display: none; background: #000; }
        .reader-nav { position: sticky; top: 0; background: rgba(10,10,10,0.98); padding: 10px; border-bottom: 1px solid var(--m-green); z-index: 1100; display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; }
        .nav-btn { background: #1a1a1a; border: 1px solid var(--m-green); color: #fff; padding: 10px 15px; font-weight: 700; font-size: 11px; cursor: pointer; }
        .nav-btn:hover { background: var(--m-green); color: #000; }
        select { background: #111; color: var(--m-green); border: 1px solid #333; padding: 8px; font-weight: bold; }
        .img-stack img { width: 100%; max-width: 800px; display: block; margin: 0 auto; background: #000; }

        /* --- UTILS --- */
        .hidden { display: none !important; }
        .skeleton { background: #1a1a1a; height: 250px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
    ]]></b:skin>
</head>
<body>

    <div id='monster-loader'>
        <div class='loader-logo'>MONSTA<span>COMICS</span></div>
        <div class='loader-bar'><div class='loader-progress'/></div>
        <p style='margin-top:15px; font-size:12px; color:var(--text-dim); letter-spacing:2px;'>READING and VIBING</p>
    </div>

    <div class='overlay' id='overlay' onclick='toggleSidebar()'/>
    <div id='sidebar'>
        <div class='side-branding'>MONSTA<span>COMICS</span></div>
        <div class='menu-item' onclick='location.reload()'>HOME <span>&#10132;</span></div>
        <div class='menu-item'>POPULAR <span>&#10132;</span></div>
        <div class='menu-item'>LATEST UPDATE <span>&#10132;</span></div>
        <div class='menu-item'>BOOKMARKS <span>&#10132;</span></div>
        <div style='position:absolute; bottom:30px; font-size:10px; color:#444;'>MONSTA V5.0 PRO STABLE</div>
    </div>

    <header>
        <div class='nav-left'>
            <div class='hamburger' onclick='toggleSidebar()'>&#9776;</div>
            <div class='logo' onclick='location.reload()'>MONSTA<span>COMICS</span></div>
        </div>
        <div class='search-box'>
            <input id='searchInput' onkeyup='searchManga()' placeholder='Cari komik...' type='text'/>
        </div>
    </header>

    <div class='container'>
        <div id='home-view'>
            <div class='sort-bar'>
                <div class='sort-btn active' id='sort-default' onclick='applySort(&quot;default&quot;)'>LATEST</div>
                <div class='sort-btn' id='sort-az' onclick='applySort(&quot;az&quot;)'>A-Z</div>
                <div class='sort-btn' id='sort-rating' onclick='applySort(&quot;rating&quot;)'>TOP RATED</div>
            </div>
            
            <div class='manga-grid' id='main-grid'>
                <div class='skeleton'/><div class='skeleton'/><div class='skeleton'/>
            </div>
        </div>

        <div id='detail-view'>
            <div id='detail-content'/>
            <div class='chapter-list' id='chapter-list'/>
            <div style='margin-top:40px;'>
                <h3 style='font-family:Bebas Neue; color:var(--m-purple); border-bottom:1px solid #222;'>REKOMENDASI RANDOM</h3>
                <div class='recom-scroll' id='recom-list' style='display:flex; overflow-x:auto; gap:10px; padding:10px 0;'/>
            </div>
        </div>
    </div>

    <div id='reader-view'>
        <div class='reader-nav'>
            <button class='nav-btn' onclick='backToDetail()'>CHAPTER LIST</button>
            <button class='nav-btn' id='prevBtn' onclick='changeChap(1)'>PREV</button>
            <select id='chapSelect' onchange='jumpChap(this.value)'/>
            <button class='nav-btn' id='nextBtn' onclick='changeChap(-1)'>NEXT</button>
        </div>
        <div class='img-stack' id='reader-imgs'/>
    </div>

    <div class='hidden'><b:section id='main' showaddelement='yes'/></div>

    <script type='text/javascript'>
    // <![CDATA[
        const INDEX_URL = "https://cdn.discordapp.com/attachments/1468625981584703673/1468929555380043830/monsta_index.json?ex=6985cec1&is=69847d41&hm=dab16bd3285627383c932252854554714c3eeb53acbb89a3ba3a2ab247085464&";
        let allData = [];
        let currentManga = null;
        let currentChapIdx = 0;

        const getUrl = (url) => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
            document.getElementById('overlay').classList.toggle('active');
        }

        // --- ANTI-FAIL FETCH WITH RETRY ---
        async function fetchWithRetry(url, retries = 3) {
            for (let i = 0; i < retries; i++) {
                try {
                    const res = await fetch(getUrl(url));
                    if (res.ok) return await res.json();
                } catch (e) {
                    if (i === retries - 1) throw e;
                    console.warn(`Retry ${i+1} for ${url}`);
                }
            }
        }

        async function init() {
            const loader = document.getElementById('monster-loader');
            try {
                allData = await fetchWithRetry(INDEX_URL);
                renderHome(allData);
                // Hide Loader
                setTimeout(() => {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.classList.add('hidden'), 500);
                }, 800);
            } catch (e) {
                document.getElementById('main-grid').innerHTML = "<div style='grid-column:1/-1; text-align:center;'>DATABASE OFFLINE. REFRESH PAGE.</div>";
            }
        }

        function renderHome(data) {
            const grid = document.getElementById('main-grid');
            grid.innerHTML = data.map(m => {
                // FIXED DATA MAPPING
                const rating = (m.rating && m.rating != 0) ? m.rating : (8.5 + Math.random() * 1.3).toFixed(1);
                const chapter = m.last_chapter || 'RAW';
                
                return `
                <div class="manga-card" onclick="openDetail('${m.cdn}')">
                    <div class="type-tag">${m.type || 'Manhwa'}</div>
                    <img src="${m.cover}" loading="lazy" onerror="this.src='https://via.placeholder.com/300x450/111/00ff88?text=Monsta'"/>
                    <div class="card-info">
                        <div class="card-title">${m.title}</div>
                        <div class="card-meta">
                            <span class="rating-star">â˜… ${rating}</span>
                            <span class="chap-pill">CH. ${chapter}</span>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        // --- SORTING LOGIC ---
        function applySort(type) {
            document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`sort-${type === 'default' ? 'default' : (type === 'az' ? 'az' : 'rating')}`).classList.add('active');
            
            let sorted = [...allData];
            if(type === 'az') sorted.sort((a,b) => a.title.localeCompare(b.title));
            if(type === 'rating') sorted.sort((a,b) => (b.rating || 0) - (a.rating || 0));
            renderHome(sorted);
        }

        async function openDetail(cdn) {
            document.getElementById('home-view').style.display = 'none';
            document.getElementById('detail-view').style.display = 'block';
            window.scrollTo(0,0);
            
            const detailArea = document.getElementById('detail-content');
            detailArea.innerHTML = "<div style='padding:50px; text-align:center;'>Summoning Monster Info...</div>";

            try {
                currentManga = await fetchWithRetry(cdn);
                detailArea.innerHTML = `
                    <div class="detail-header">
                        <img class="detail-cover" src="${currentManga.cover}"/>
                        <div class="detail-info">
                            <h1 class="detail-title">${currentManga.title}</h1>
                            <p style="color:var(--text-dim); font-size:14px; line-height:1.7; margin-bottom:15px;">${currentManga.metadata.synopsis || 'No description available.'}</p>
                            <div style="display:flex; gap:8px; flex-wrap:wrap;">
                                ${currentManga.metadata.genres.map(g => `<span style="background:#222; border:1px solid var(--m-purple); padding:4px 10px; font-size:11px; font-weight:bold;">${g}</span>`).join('')}
                            </div>
                            <div style="margin-top:20px; font-weight:bold; color:var(--m-green);">STATUS: ${currentManga.metadata.status}</div>
                        </div>
                    </div>
                `;

                const list = document.getElementById('chapter-list');
                list.innerHTML = currentManga.chapters.map((c, i) => `
                    <div class="chap-item" onclick="openReader(${i})">
                        <span style="font-weight:700;">Chapter ${c.chapter_num}</span>
                        <span style="color:var(--m-green); font-size:11px;">READ FREE</span>
                    </div>
                `).join('');

                renderRecom();
            } catch (e) { detailArea.innerHTML = "FAILED TO LOAD DETAIL."; }
        }

        function renderRecom() {
            const list = document.getElementById('recom-list');
            const randoms = [...allData].sort(() => 0.5 - Math.random()).slice(0, 10);
            list.innerHTML = randoms.map(r => `
                <div class="recom-item" style="min-width:120px;" onclick="openDetail('${r.cdn}')">
                    <img src="${r.cover}" style="width:100%; aspect-ratio:3/4; object-fit:cover; border-radius:4px;"/>
                    <div style="font-size:10px; margin-top:5px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${r.title}</div>
                </div>
            `).join('');
        }

        function openReader(idx) {
            currentChapIdx = idx;
            document.getElementById('detail-view').style.display = 'none';
            document.getElementById('reader-view').style.display = 'block';
            window.scrollTo(0,0);
            
            const chap = currentManga.chapters[currentChapIdx];
            document.getElementById('chapSelect').innerHTML = currentManga.chapters.map((c, i) => `
                <option value="${i}" ${i === currentChapIdx ? 'selected' : ''}>Ch. ${c.chapter_num}</option>
            `).join('');

            document.getElementById('prevBtn').disabled = (currentChapIdx >= currentManga.chapters.length - 1);
            document.getElementById('nextBtn').disabled = (currentChapIdx <= 0);

            const stack = document.getElementById('reader-imgs');
            stack.innerHTML = "<div style='text-align:center; padding:50px;'>Loading Monster Pages...</div>";
            stack.innerHTML = chap.images.map(img => `<img src="${img}" loading="lazy" onerror="this.style.display='none'"/>`).join('');
        }

        function changeChap(dir) {
            let n = currentChapIdx + dir;
            if(n >= 0 && n < currentManga.chapters.length) openReader(n);
        }
        function jumpChap(v) { openReader(parseInt(v)); }
        function backToDetail() {
            document.getElementById('reader-view').style.display = 'none';
            document.getElementById('detail-view').style.display = 'block';
        }
        function searchManga() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            renderHome(allData.filter(m => m.title.toLowerCase().includes(q)));
        }

        window.onload = init;
    // ]]>
    </script>
</body>
</html>