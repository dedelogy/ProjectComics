<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html b:css='false' b:defaultmessages='false' b:layoutsVersion='3' b:responsive='true' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
    <title>MonstaComics V4.0</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1' name='viewport'/>
    <link href='https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&amp;display=swap' rel='stylesheet'/>
    
    <b:skin><![CDATA[
        /* --- CORE MONSTER THEME --- */
        :root {
            --bg: #0b0b0b;
            --card: #121212;
            --m-green: #00ff88;  /* Border Monster */
            --m-purple: #a349f5; /* Glow Shadow */
            --text: #ffffff;
            --text-dim: #888;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            margin: 0; padding: 0;
        }

        header {
            background: #111;
            padding: 15px 5%;
            display: flex; align-items: center;
            border-bottom: 1px solid #222;
            position: sticky; top: 0; z-index: 1000;
        }
        .logo { font-weight: 900; letter-spacing: 2px; font-size: 20px; cursor: pointer; }
        .logo span { color: var(--m-purple); }

        /* --- HOME GRID SYSTEM --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 25px; }
        .manga-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(165px, 1fr));
            gap: 25px;
        }

        /* THE CARD: BINGKAI HIJAU + SHADOW UNGU */
        .manga-card {
            background: var(--card);
            border: 1.5px solid var(--m-green);
            box-shadow: 0 4px 12px rgba(163, 73, 245, 0.15);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            position: relative;
        }
        .manga-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(163, 73, 245, 0.6); /* Glow Ungu Kuat */
        }

        .manga-card img { width: 100%; aspect-ratio: 3/4; object-fit: cover; display: block; }
        .card-info { padding: 12px; background: #111; }
        .m-title { font-size: 13px; font-weight: 700; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .m-meta { display: flex; justify-content: space-between; align-items: center; }
        .m-rating { color: var(--m-green); font-weight: 900; font-size: 11px; }

        /* --- READER VIEW --- */
        #reader-view { display: none; background: #000; min-height: 100vh; }
        .reader-nav {
            position: sticky; top: 0; background: rgba(11,11,11,0.95);
            padding: 15px; border-bottom: 1px solid var(--m-green);
            display: flex; align-items: center; z-index: 1100;
        }
        .btn-back { background: var(--m-purple); color: #fff; border: none; padding: 8px 20px; font-weight: bold; cursor: pointer; }
        .img-stack img { width: 100%; max-width: 800px; display: block; margin: 0 auto; }

        .hidden { display: none !important; }
        @media (max-width: 480px) { .manga-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; } }
    ]]></b:skin>
</head>
<body>
    <header><div class='logo' onclick='window.location.reload()'>MONSTA<span>COMICS</span></div></header>

    <div class='container' id='home-view'>
        <div class='manga-grid' id='main-grid'>
            <div style='color:var(--m-green)'>Summoning Monsters...</div>
        </div>
    </div>

    <div id='reader-view'>
        <div class='reader-nav'>
            <button class='btn-back' onclick='window.location.reload()'>CLOSE</button>
            <div id='nav-title' style='margin-left:20px; font-weight:bold;'/>
        </div>
        <div class='img-stack' id='reader-imgs'/>
    </div>

    <div class='hidden'><b:section id='main' showaddelement='yes'/></div>

    <script type='text/javascript'>
    // <![CDATA[
    // URL Asli dari Indexer Bos
    const RAW_INDEX_URL = "https://cdn.discordapp.com/attachments/1468625981584703673/1468929555380043830/monsta_index.json?ex=6985cec1&is=69847d41&hm=dab16bd3285627383c932252854554714c3eeb53acbb89a3ba3a2ab247085464&";

    // Menggunakan Proxy AllOrigins untuk menembus blokir CORS
    const INDEX_URL = `https://api.allorigins.win/raw?url=${encodeURIComponent(RAW_INDEX_URL)}`;

    async function init() {
        const grid = document.getElementById('main-grid');
        try {
            console.log("Summoning Monsters via Proxy...");
            const res = await fetch(INDEX_URL);
            
            if(!res.ok) throw new Error();
            
            const data = await res.json();
            
            // Render Home Page
            grid.innerHTML = data.map(m => `
                <div class="manga-card" onclick="openManga('${m.cdn}')">
                    <img src="${m.cover}" loading="lazy"/>
                    <div class="card-info">
                        <div class="m-title">${m.title}</div>
                        <div class="m-meta">
                            <span class="m-rating">â˜… ${m.rating}</span>
                            <span style="font-size:9px; color:var(--m-purple); border:1px solid var(--m-purple); padding:1px 4px; font-weight:bold;">${m.type}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
        } catch (e) {
            console.error("Fetch Error:", e);
            grid.innerHTML = `
                <div style='grid-column:1/-1; text-align:center; padding:50px; border:1px dashed var(--m-purple);'>
                    <p style='color:var(--m-green); font-weight:bold;'>MONSTA CONNECTION ERROR</p>
                    <p style='color:#666; font-size:12px;'>Browser memblokir akses langsung ke Discord. Mencoba menggunakan jalur alternatif...</p>
                    <button onclick='location.reload()' style='background:var(--m-green); border:none; padding:10px 20px; cursor:pointer; font-weight:bold; margin-top:10px;'>TRY RE-SUMMON</button>
                </div>
            `;
        }
    }

    async function openManga(cdnUrl) {
        // Gunakan proxy juga untuk detail JSON komiknya
        const proxyCdnUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(cdnUrl)}`;
        
        document.getElementById('home-view').style.display = 'none';
        document.getElementById('reader-view').style.display = 'block';
        window.scrollTo(0,0);
        
        const imgContainer = document.getElementById('reader-imgs');
        imgContainer.innerHTML = "<div class='skeleton' style='height:80vh; width:100%;'></div>";

        try {
            const res = await fetch(proxyCdnUrl);
            const data = await res.json();
            
            document.getElementById('nav-title').innerText = data.title;
            
            // Render semua gambar di chapter pertama
            const images = data.chapters[0].images;
            imgContainer.innerHTML = images.map(i => `<img src="${i}" loading="lazy" style="width:100%; max-width:800px; display:block; margin:0 auto;"/>`).join('');
            
        } catch (e) {
            alert("Gagal memuat chapter. Cek link Discord Bos.");
        }
    }

    window.onload = init;
// ]]>
    </script>
</body>
</html>